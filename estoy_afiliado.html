<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
		<title>ONP - ¿Estoy afiliado?</title>
		<!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <!--[if lt IE 9]><script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script><![endif]-->
		<script src="res/js/jquery-2.1.1.min.js" type="text/javascript"></script>
		<script src="res/js/jquery.mobile-1.4.3.min.js" type="text/javascript"></script>  
		<script src="res/js/jquery.jsonp-2.4.0.min.js" type="text/javascript"></script> 
        <link href="res/css/jquery.mobile-1.4.3.min.css" rel="stylesheet" type="text/css"/>
        <link href="res/css/reset.css" rel="stylesheet" type="text/css" />
        <link href="res/css/general.css" rel="stylesheet" type="text/css" />
        <script src="res/js/cordova.js" type="text/javascript"></script>
		<script type='text/javascript'>
		
			$("#response").hide();
			
            $(document).ready(function () {
				
					var content = $.mobile.getScreenHeight() - $(".ui-header").outerHeight() - $(".ui-footer").outerHeight() - $(".ui-content").outerHeight() + $(".ui-content").height() -30;
		
					$(".ui-content").height(content);
							
					$("#response").val("");

                    $.support.cors = true;
                    $.mobile.allowCrossDomainPages = true;
                    
                    $("#cmdConsumir").click(function (event){
                        var tipoDocumento = document.getElementById("tipoDocumento").value;
                        var numeroDocumento = document.getElementById("numeroDocumento").value;
                        if(tipoDocumento == ""){
							$("#response").css("background-color","#FC0");	
							$("#response").text("Seleccione el tipo de documento.");
							$("#response").show();
                            return;
                        }
                        if(numeroDocumento == ""){
							$("#response").css("background-color","#FC0");	
							$("#response").text("Ingrese el numero de documento.");						
							$("#response").show();							
                            return;
                        }
                        var params = "?tipoDocumento="+tipoDocumento+"&numeroDocumento="+numeroDocumento;
                        $.ajax({
                            url: 'http://app.onp.gob.pe/WSMovilesQA/MAFServiceServlet'+params,
                            cache: true,
                            type: 'GET',
                            async: false, // must be set to false
                            success: function (data, success) {
								$("#response").show();
								$("#response").css("background-color","#c8d8ab");
								var resultado = data.resultado;
								if(resultado == 'ONP')								
                                	$("#response").text("Ud. está afiliado a la ONP.");
								else if(resultado == 'SPP')
									$("#response").text("Ud. está afiliado al Sistema Privado de Pensiones.");
								else if(resultado == "NOINFO")
									$("#response").text("No contamos con información de su Sistema Previsional.");
								else
									$("#response").text("Ocurrió un error inesperado.");
                            },
                            dataType: 'jsonp',
                            error :function( jqxhr, textStatus, error ) { 
                                //var err = textStatus + ', ' + error;
                                //alert(err);
                            },
                            complete: function (jqxhr, textStatus ){
                                //alert( "complete: " + JSON.stringify(jqxhr)+" "+ textStatus );
                            }
                        });					
                    });
                });
        </script>
	</head>
	<body>
    	<div data-role="page" id="afiliado">
            <div data-role="header">
                        <a href="index.html" data-role="button" data-icon="home" data-iconpos="notext" class="ui-btn-left">Inicio</a>
                        <h1>¿ESTOY AFILIADO?</h1>
            </div>
            <div data-role="content" id="afiliado-content" align="center">
            			<label for="tipoDocumento" class="labelOnp">Tipo de Documento (*)</label>
                        <select id="tipoDocumento" name="numeroDocumento">
                            <option value="00">DOC. TRIB. SIN RUC</option>
                            <option value="01" selected>D.N.I.</option>
                            <option value="02">LIBRETA ELECTORAL</option>
                            <option value="03">CARNET FF.PP.</option>
                            <option value="04">CARNET FF.AA.</option>
                            <option value="05">CARNET EXTRANJERIA</option>
                            <option value="06">PASAPORTE</option>
                            <option value="07">D.P.I</option>
                            <option value="08">R.U.C 11 DIG.</option>
                            <option value="09">R.U.C 8 DIG.</option>
                            <option value="10">LIBRETA TRIBUTARIA</option>
                            <option value="11">S/N IDENT. FISCAL</option>
                            <option value="12">REG. PATRONAL</option>
                            <option value="13">CED. DIPLOMATICA</option>
                            <option value="14">PARTIDA NACIMIENTO</option>
                            <option value="15">LIBRETA MILITAR</option>
                            <option value="16">AUTOGENERADO</option>
                            <option value="17">DOC. EDU. SUP.</option>
                            <option value="18">TRAB. MEN. EDAD</option>
                            <option value="19">TRAB. MENOR EDAD</option>
                            <option value="20">INTERDICTO</option>
                            <option value="21">COD. INSC. EMPL. TH</option>
                            <option value="22">LIC. CONDUCIR</option>
                            <option value="23">NO DEFINIDO</option>
                            <option value="24">NRO. REG. SUNAT</option>
                            <option value="25">CARNET SOL. REFUG.</option>
                        </select>
                        <br />
                        <label for="numeroDocumento" class="labelOnp">Número de Documento (*)</label>
                        <input type="text" name="numeroDocumento" id="numeroDocumento">
                        <br />
                        <div>
                            <input type="button" value="CONSULTAR" id="cmdConsumir" name="cmdConsumir" />
                        </div>
                        <br />
	                   <div id="response" class="infoOnp" style="display:none;">
                   </div>                   
            </div>            
            <div data-role="footer">
				<h4>Mobile ONP © Copyright 2014</h4>
			</div>
        </div>
        
	</body>
</html>